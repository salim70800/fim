import{d as S,r,j as e,L as k}from"./react-core-Cfr18xtl.js";import{s as x}from"./supabase-BWlcyJjF.js";import{D}from"./DynamicSEO-BuC0_snW.js";import{S as E}from"./StructuredData-3nAFOEiM.js";import{V as q}from"./VideoPlayer-pE8VtgNi.js";import{C as M}from"./ContentCard-Dvg_uoT_.js";import{F as h,b as C,c as L,d as P,G as U,H as F,e as G,U as $,T as H}from"./lucide-Dk-NOH9t.js";import"./vendor-CKCmSFOu.js";import"./supabase-Mw2DHMHY.js";function K(){const{id:a}=S(),[s,N]=r.useState(null),[m,v]=r.useState([]),[g,w]=r.useState([]),[p,_]=r.useState([]),[y,u]=r.useState(!0);return r.useEffect(()=>{(async()=>{if(a)try{u(!0);const{data:l,error:j}=await x.from("content").select("*").eq("id",a).eq("type","movie").single();if(j)throw j;N(l);const{data:n}=await x.from("content_genres").select("genre_id, genres(*)").eq("content_id",a);if(n){const d=[];n.forEach(i=>{i.genres&&d.push(i.genres)}),v(d)}const{data:f}=await x.from("servers").select("*").eq("content_id",a).eq("is_active",!0).order("priority",{ascending:!0});if(f&&w(f),n&&n.length>0){const d=n.map(o=>o.genre_id),{data:i}=await x.from("content_genres").select("content_id, content(*)").in("genre_id",d).neq("content_id",a).limit(8);if(i){const o=[],b=new Set;i.forEach(c=>{c.content&&c.content.type==="movie"&&!b.has(c.content.id)&&(o.push(c.content),b.add(c.content.id))}),_(o.slice(0,6))}}}catch(l){console.error("Error fetching movie:",l)}finally{u(!1)}})()},[a]),y?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-400",children:"جاري التحميل..."})]})}):s?e.jsxs(e.Fragment,{children:[e.jsx(D,{content:s,type:"movie"}),e.jsx(E,{content:s,genres:m,type:"movie",breadcrumbs:[{name:"الرئيسية",url:"/"},{name:"الأفلام",url:"/movies"},{name:s.title_ar,url:`/movie/${s.id}`}]}),e.jsxs("div",{className:"min-h-screen bg-black",children:[e.jsxs("div",{className:"relative h-[60vh] md:h-[70vh]",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:s.banner_url||s.poster_url||"/placeholder.jpg",alt:s.title_ar,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"})]}),e.jsx("div",{className:"relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-end pb-12",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 md:gap-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:s.poster_url||"/placeholder.jpg",alt:s.title_ar,className:"w-48 md:w-64 rounded-lg shadow-2xl"})}),e.jsxs("div",{className:"flex-1 text-white",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:s.title_ar}),s.title_en&&e.jsx("p",{className:"text-xl md:text-2xl text-neutral-300 mb-4",children:s.title_en}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 text-sm md:text-base",children:[s.year&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:s.year})]}),s.duration&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.duration," دقيقة"]})]}),s.imdb_rating&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-orange-500/20 px-3 py-1 rounded-full",children:[e.jsx(P,{className:"w-4 h-4 fill-orange-500 text-orange-500"}),e.jsx("span",{className:"font-semibold",children:s.imdb_rating})]}),s.country&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:s.country})]}),s.language&&e.jsx("span",{className:"px-3 py-1 bg-neutral-800 rounded-full text-sm",children:s.language})]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:m.map(t=>e.jsx("span",{className:"px-3 py-1 bg-white/10 backdrop-blur-sm rounded-full text-sm",children:t.name_ar},t.id))}),s.description&&e.jsx("p",{className:"text-neutral-300 text-base md:text-lg leading-relaxed max-w-3xl",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-6",children:[e.jsxs("button",{className:"px-6 py-2.5 bg-orange-500 hover:bg-orange-600 rounded-lg font-semibold transition-colors flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5"}),e.jsx("span",{children:"مشاهدة الآن"})]}),e.jsxs("button",{className:"px-6 py-2.5 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg font-semibold transition-colors flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsx("span",{children:"إضافة للمفضلة"})]}),e.jsxs("button",{className:"px-6 py-2.5 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg font-semibold transition-colors flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{children:"مشاركة"})]})]})]})]})})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-12",children:[g.length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"مشاهدة الفيلم"}),e.jsx(q,{servers:g,title:s.title_ar,autoPlay:!1})]}),e.jsxs("section",{className:"grid md:grid-cols-2 gap-6",children:[s.movie_cast&&e.jsxs("div",{className:"bg-neutral-900 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-orange-500"}),"طاقم التمثيل"]}),e.jsx("p",{className:"text-neutral-300 leading-relaxed",children:s.movie_cast})]}),s.director&&e.jsxs("div",{className:"bg-neutral-900 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-orange-500"}),"الإخراج"]}),e.jsx("p",{className:"text-neutral-300 leading-relaxed",children:s.director})]})]}),s.gallery_urls&&s.gallery_urls.length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"معرض الصور"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.gallery_urls.map((t,l)=>e.jsx("img",{src:t,alt:`${s.title_ar} - صورة ${l+1}`,className:"w-full aspect-video object-cover rounded-lg hover:scale-105 transition-transform duration-300"},l))})]}),p.length>0&&e.jsxs("section",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(H,{className:"w-6 h-6 text-orange-500"}),"أفلام مشابهة"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:p.map(t=>e.jsx(M,{id:t.id,title:t.title_ar,year:t.year,rating:t.imdb_rating||t.user_rating,posterUrl:t.poster_url,type:t.type,language:t.language},t.id))})]})]})]})]}):e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(h,{className:"w-16 h-16 text-neutral-600 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-400 text-lg",children:"الفيلم غير موجود"}),e.jsx(k,{to:"/movies",className:"text-orange-500 hover:text-orange-400 mt-4 inline-block",children:"العودة إلى الأفلام"})]})})}export{K as default};
