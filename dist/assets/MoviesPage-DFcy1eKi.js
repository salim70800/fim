import{r,j as t}from"./react-core-Cfr18xtl.js";import{s as x}from"./supabase-BWlcyJjF.js";import{C as y}from"./ContentCard-Dvg_uoT_.js";import"./vendor-CKCmSFOu.js";import"./supabase-Mw2DHMHY.js";import"./lucide-Dk-NOH9t.js";function G(){const[i,g]=r.useState([]),[p,o]=r.useState(!0),[a,c]=r.useState("all"),[d,f]=r.useState([]);r.useEffect(()=>{h(),b()},[a]);const h=async()=>{const{data:e}=await x.from("genres").select("*");e&&f(e)},b=async()=>{o(!0);try{let e=x.from("content").select(`
          *,
          content_genres (
            genres (name_ar, slug)
          )
        `).eq("type","movie").eq("status","published").order("created_at",{ascending:!1});const{data:u}=await e;if(u){let n=u.map(s=>({...s,rating:s.imdb_rating,views:0,genres:s.content_genres?.map(l=>l.genres?.name_ar).filter(Boolean)||[]}));a!=="all"&&(n=n.filter(s=>s.genres.some(l=>d.find(m=>m.slug===a&&m.name_ar===l)))),g(n)}}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen pt-24 pb-16",children:t.jsxs("div",{className:"container mx-auto px-4",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-h1 font-bold text-neutral-200 mb-2",children:"الأفلام"}),t.jsx("p",{className:"text-body-large text-neutral-400",children:"اكتشف مجموعة واسعة من الأفلام العربية والعالمية"})]}),t.jsxs("div",{className:"mb-8 flex gap-3 overflow-x-auto hide-scrollbar pb-4",children:[t.jsx("button",{onClick:()=>c("all"),className:`px-5 py-2 rounded-full text-small font-medium transition-all duration-fast whitespace-nowrap ${a==="all"?"bg-primary-500 text-neutral-950":"bg-neutral-800 text-neutral-400 hover:bg-neutral-700 hover:text-neutral-200"}`,children:"الكل"}),d.map(e=>t.jsx("button",{onClick:()=>c(e.slug),className:`px-5 py-2 rounded-full text-small font-medium transition-all duration-fast whitespace-nowrap ${a===e.slug?"bg-primary-500 text-neutral-950":"bg-neutral-800 text-neutral-400 hover:bg-neutral-700 hover:text-neutral-200"}`,children:e.name_ar},e.id))]}),p?t.jsx("div",{className:"text-center text-neutral-400 py-20",children:"جاري التحميل..."}):i.length===0?t.jsx("div",{className:"text-center text-neutral-400 py-20",children:"لا توجد أفلام"}):t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6",children:i.map(e=>t.jsx(y,{id:e.id,title:e.title_ar,year:e.year,rating:e.rating,views:e.views,posterUrl:e.poster_url,genres:e.genres,type:"movie",language:e.language},e.id))})]})})}export{G as default};
